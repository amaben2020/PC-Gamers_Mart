{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/user/Desktop/Proshop Ecommerce/frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/user/Desktop/Proshop Ecommerce/frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/user/Desktop/Proshop Ecommerce/frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import ErrorMessage from\"./../../messages/ErrorMessage\";import{Link}from\"react-router-dom\";import{Form,Button}from\"react-bootstrap\";import Loading from\"./../../messages/Loading\";import FormContainer from\"./FormContainer/FormContainer.js\";import{updateUser}from\"./../../actions/userActions\";import{getUserDetails,getUserForAdmin}from\"./../../actions/userActions\";import{Row}from\"react-bootstrap\";import{USER_UPDATE_RESET}from\"../../constants/userConstants.js\";import{productDetailsAction}from\"./../../actions/productListActions\";import{PRODUCT_UPDATE_RESET}from\"../../constants/constants\";import{productUpdateAction}from\"./../../actions/productListActions\";import axios from\"axios\";//yOU SIMPLY GET THE PRODUCT YOU WANNA EDIT\nimport{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ProductEditScreen=function ProductEditScreen(_ref){var location=_ref.location,history=_ref.history,match=_ref.match;var productId=match.params.id;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),description=_useState2[0],setDescription=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),price=_useState6[0],setPrice=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),name=_useState8[0],setName=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),brand=_useState10[0],setBrand=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),countInStock=_useState12[0],setCountInStock=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),category=_useState14[0],setCategory=_useState14[1];//creating the image loading state\nvar _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),uploadingLoading=_useState16[0],setUploadingLoading=_useState16[1];var dispatch=useDispatch();var userId=match.params.id;var productDetails=useSelector(function(state){return state.productDetails;});var product=productDetails.product;var productUpdate=useSelector(function(state){return state.productUpdate;});var loadingUpdate=productUpdate.loading,errorUpdate=productUpdate.error,success=productUpdate.success;var adminProfileList=useSelector(function(state){return state.adminProfileList;});var loadingAdminProfileEdit=adminProfileList.loading,errorAdminProfileEdit=adminProfileList.error,userAdminProfileEdit=adminProfileList.user;useEffect(function(){//if successfully updated, clear the fields and push\nif(success){dispatch({type:PRODUCT_UPDATE_RESET});history.push(\"/admin/productlist\");}else{// simply render the list of products if there are none\nif(!product.name||product._id!==productId){dispatch(productDetailsAction(productId));}else{setName(product.name);setBrand(product.brand);setDescription(product.description);setImage(product.image);setPrice(product.price);setCountInStock(product.countInStock);setCategory(product.category);}}},[dispatch,success,history,product._id,product.name,product.brand,product.description,product.image,product.price,product.countInStock,product.category,productId]);//The submit handler simply sends the form value to the backend/DB\nvar submitHandler=function submitHandler(e){e.preventDefault();dispatch(productUpdateAction({_id:productId,name:name,category:category,brand:brand,countInStock:countInStock,description:description,price:price,image:image}));};var uploadFileHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,formData,config,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:file=e.target.files[0];//first item in a large object\nformData=new FormData();formData.append(\"image\",file);setUploadingLoading(true);_context.prev=4;config={headers:{\"Content-Type\":\"multipart/form-data\"}};_context.next=8;return axios.post(\"/api/upload\",formData,config);case 8:_yield$axios$post=_context.sent;data=_yield$axios$post.data;setImage(data);setUploadingLoading(false);_context.next=18;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](4);console.error(_context.t0);setUploadingLoading(false);case 18:case\"end\":return _context.stop();}}},_callee,null,[[4,14]]);}));return function uploadFileHandler(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Link,{to:\"/admin/productlist\",className:\"btn btn-light my-3\",children:[\" \",\"Go Back\"]}),/*#__PURE__*/_jsxs(FormContainer,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\" Edit Product\"}),success&&/*#__PURE__*/_jsxs(ErrorMessage,{children:[\"Product successfully updated\",/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check\"})]}),loadingUpdate&&/*#__PURE__*/_jsx(Loading,{}),errorUpdate&&/*#__PURE__*/_jsx(ErrorMessage,{variant:\"danger\",children:errorUpdate}),loadingAdminProfileEdit?/*#__PURE__*/_jsx(Loading,{}):errorAdminProfileEdit?/*#__PURE__*/_jsxs(ErrorMessage,{variant:\"danger\",children:[\" \",errorAdminProfileEdit]}):/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"name\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"name\",placeholder:\"Enter Name\",value:name,onChange:function onChange(e){return setName(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"price\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Enter price\",value:price,onChange:function onChange(e){return setPrice(e.target.value);}})]}),/*#__PURE__*/_jsx(Form.Group,{controlId:\"image\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Form.Label,{className:\"mr-3\",children:\"Image\"}),/*#__PURE__*/_jsx(Form.Check,{placeholder:\"Enter image url \",type:\"text\",value:image,onChange:function onChange(e){return setImage(e.target.value);}})]})}),uploadingLoading&&/*#__PURE__*/_jsx(Loading,{}),/*#__PURE__*/_jsx(Form.File,{id:\"image-file\",label:\"Choose File\",custom:true,onChange:uploadFileHandler}),/*#__PURE__*/_jsx(Form.Group,{controlId:\"brand\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Form.Label,{className:\"mr-3\",children:\"Brand\"}),/*#__PURE__*/_jsx(Form.Check,{type:\"text\",value:brand,onChange:function onChange(e){return setBrand(e.target.value);}})]})}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"description\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Description\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter description\",value:description,onChange:function onChange(e){return setDescription(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"category\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Category\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter category\",value:category,onChange:function onChange(e){return setCategory(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"countInStock\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Count In Stock\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Enter count In Stock\",value:countInStock,onChange:function onChange(e){return setCountInStock(e.target.value);}})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",children:\"UPDATE\"})]})]})]});};export default ProductEditScreen;","map":{"version":3,"sources":["C:/Users/user/Desktop/Proshop Ecommerce/frontend/frontend/src/components/screen/ProductEditScreen.jsx"],"names":["React","useState","useEffect","useDispatch","useSelector","ErrorMessage","Link","Form","Button","Loading","FormContainer","updateUser","getUserDetails","getUserForAdmin","Row","USER_UPDATE_RESET","productDetailsAction","PRODUCT_UPDATE_RESET","productUpdateAction","axios","ProductEditScreen","location","history","match","productId","params","id","description","setDescription","image","setImage","price","setPrice","name","setName","brand","setBrand","countInStock","setCountInStock","category","setCategory","uploadingLoading","setUploadingLoading","dispatch","userId","productDetails","state","product","productUpdate","loadingUpdate","loading","errorUpdate","error","success","adminProfileList","loadingAdminProfileEdit","errorAdminProfileEdit","userAdminProfileEdit","user","type","push","_id","submitHandler","e","preventDefault","uploadFileHandler","file","target","files","formData","FormData","append","config","headers","post","data","console","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport ErrorMessage from \"./../../messages/ErrorMessage\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Form, Button } from \"react-bootstrap\";\r\nimport Loading from \"./../../messages/Loading\";\r\nimport FormContainer from \"./FormContainer/FormContainer.js\";\r\nimport { updateUser } from \"./../../actions/userActions\";\r\nimport { getUserDetails, getUserForAdmin } from \"./../../actions/userActions\";\r\nimport { Row } from \"react-bootstrap\";\r\nimport { USER_UPDATE_RESET } from \"../../constants/userConstants.js\";\r\nimport { productDetailsAction } from \"./../../actions/productListActions\";\r\nimport { PRODUCT_UPDATE_RESET } from \"../../constants/constants\";\r\nimport { productUpdateAction } from \"./../../actions/productListActions\";\r\nimport axios from \"axios\";\r\n\r\n//yOU SIMPLY GET THE PRODUCT YOU WANNA EDIT\r\nconst ProductEditScreen = ({ location, history, match }) => {\r\n\tconst productId = match.params.id;\r\n\tconst [description, setDescription] = useState(\"\");\r\n\tconst [image, setImage] = useState(\"\");\r\n\tconst [price, setPrice] = useState(0);\r\n\tconst [name, setName] = useState(\"\");\r\n\tconst [brand, setBrand] = useState(\"\");\r\n\tconst [countInStock, setCountInStock] = useState(0);\r\n\tconst [category, setCategory] = useState(\"\");\r\n\r\n\t//creating the image loading state\r\n\tconst [uploadingLoading, setUploadingLoading] = useState(false);\r\n\r\n\tconst dispatch = useDispatch();\r\n\r\n\tconst userId = match.params.id;\r\n\r\n\tconst productDetails = useSelector((state) => state.productDetails);\r\n\tconst { product } = productDetails;\r\n\r\n\tconst productUpdate = useSelector((state) => state.productUpdate);\r\n\tconst { loading: loadingUpdate, error: errorUpdate, success } = productUpdate;\r\n\r\n\tconst adminProfileList = useSelector((state) => state.adminProfileList);\r\n\tconst {\r\n\t\tloading: loadingAdminProfileEdit,\r\n\t\terror: errorAdminProfileEdit,\r\n\t\tuser: userAdminProfileEdit,\r\n\t} = adminProfileList;\r\n\r\n\tuseEffect(() => {\r\n\t\t//if successfully updated, clear the fields and push\r\n\t\tif (success) {\r\n\t\t\tdispatch({ type: PRODUCT_UPDATE_RESET });\r\n\t\t\thistory.push(\"/admin/productlist\");\r\n\t\t} else {\r\n\t\t\t// simply render the list of products if there are none\r\n\t\t\tif (!product.name || product._id !== productId) {\r\n\t\t\t\tdispatch(productDetailsAction(productId));\r\n\t\t\t} else {\r\n\t\t\t\tsetName(product.name);\r\n\t\t\t\tsetBrand(product.brand);\r\n\t\t\t\tsetDescription(product.description);\r\n\t\t\t\tsetImage(product.image);\r\n\t\t\t\tsetPrice(product.price);\r\n\t\t\t\tsetCountInStock(product.countInStock);\r\n\t\t\t\tsetCategory(product.category);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [\r\n\t\tdispatch,\r\n\t\tsuccess,\r\n\t\thistory,\r\n\t\tproduct._id,\r\n\t\tproduct.name,\r\n\t\tproduct.brand,\r\n\t\tproduct.description,\r\n\t\tproduct.image,\r\n\t\tproduct.price,\r\n\t\tproduct.countInStock,\r\n\t\tproduct.category,\r\n\t\tproductId,\r\n\t]);\r\n\t//The submit handler simply sends the form value to the backend/DB\r\n\tconst submitHandler = (e) => {\r\n\t\te.preventDefault();\r\n\t\tdispatch(\r\n\t\t\tproductUpdateAction({\r\n\t\t\t\t_id: productId,\r\n\t\t\t\tname,\r\n\t\t\t\tcategory,\r\n\t\t\t\tbrand,\r\n\t\t\t\tcountInStock,\r\n\t\t\t\tdescription,\r\n\t\t\t\tprice,\r\n\t\t\t\timage,\r\n\t\t\t})\r\n\t\t);\r\n\t};\r\n\r\n\tconst uploadFileHandler = async (e) => {\r\n\t\tconst file = e.target.files[0]; //first item in a large object\r\n\t\tconst formData = new FormData();\r\n\t\tformData.append(\"image\", file);\r\n\t\tsetUploadingLoading(true);\r\n\r\n\t\ttry {\r\n\t\t\tconst config = {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t\"Content-Type\": \"multipart/form-data\",\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t\tconst { data } = await axios.post(\"/api/upload\", formData, config);\r\n\t\t\tsetImage(data);\r\n\t\t\tsetUploadingLoading(false);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\tsetUploadingLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Link to=\"/admin/productlist\" className=\"btn btn-light my-3\">\r\n\t\t\t\t{\" \"}\r\n\t\t\t\tGo Back\r\n\t\t\t</Link>\r\n\t\t\t<FormContainer>\r\n\t\t\t\t<h1> Edit Product</h1>\r\n\t\t\t\t{success && (\r\n\t\t\t\t\t<ErrorMessage>\r\n\t\t\t\t\t\tProduct successfully updated\r\n\t\t\t\t\t\t<i className=\"fas fa-check\"></i>\r\n\t\t\t\t\t</ErrorMessage>\r\n\t\t\t\t)}\r\n\t\t\t\t{loadingUpdate && <Loading />}\r\n\t\t\t\t{errorUpdate && (\r\n\t\t\t\t\t<ErrorMessage variant=\"danger\">{errorUpdate}</ErrorMessage>\r\n\t\t\t\t)}\r\n\t\t\t\t{loadingAdminProfileEdit ? (\r\n\t\t\t\t\t<Loading />\r\n\t\t\t\t) : errorAdminProfileEdit ? (\r\n\t\t\t\t\t<ErrorMessage variant=\"danger\"> {errorAdminProfileEdit}</ErrorMessage>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<Form onSubmit={submitHandler}>\r\n\t\t\t\t\t\t<Form.Group controlId=\"name\">\r\n\t\t\t\t\t\t\t<Form.Label>Name</Form.Label>\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"name\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Enter Name\"\r\n\t\t\t\t\t\t\t\tvalue={name}\r\n\t\t\t\t\t\t\t\tonChange={(e) => setName(e.target.value)}\r\n\t\t\t\t\t\t\t></Form.Control>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group controlId=\"price\">\r\n\t\t\t\t\t\t\t<Form.Label>Price</Form.Label>\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Enter price\"\r\n\t\t\t\t\t\t\t\tvalue={price}\r\n\t\t\t\t\t\t\t\tonChange={(e) => setPrice(e.target.value)}\r\n\t\t\t\t\t\t\t></Form.Control>\r\n\t\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t\t<Form.Group controlId=\"image\">\r\n\t\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t\t<Form.Label className=\"mr-3\">Image</Form.Label>\r\n\t\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\t\tplaceholder=\"Enter image url \"\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\tvalue={image}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setImage(e.target.value)}\r\n\t\t\t\t\t\t\t\t></Form.Check>\r\n\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t\t{uploadingLoading && <Loading />}\r\n\t\t\t\t\t\t<Form.File\r\n\t\t\t\t\t\t\tid=\"image-file\"\r\n\t\t\t\t\t\t\tlabel=\"Choose File\"\r\n\t\t\t\t\t\t\tcustom\r\n\t\t\t\t\t\t\tonChange={uploadFileHandler}\r\n\t\t\t\t\t\t></Form.File>\r\n\t\t\t\t\t\t<Form.Group controlId=\"brand\">\r\n\t\t\t\t\t\t\t<Row>\r\n\t\t\t\t\t\t\t\t<Form.Label className=\"mr-3\">Brand</Form.Label>\r\n\t\t\t\t\t\t\t\t<Form.Check\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\tvalue={brand}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setBrand(e.target.value)}\r\n\t\t\t\t\t\t\t\t></Form.Check>\r\n\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group controlId=\"description\">\r\n\t\t\t\t\t\t\t<Form.Label>Description</Form.Label>\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Enter description\"\r\n\t\t\t\t\t\t\t\tvalue={description}\r\n\t\t\t\t\t\t\t\tonChange={(e) => setDescription(e.target.value)}\r\n\t\t\t\t\t\t\t></Form.Control>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group controlId=\"category\">\r\n\t\t\t\t\t\t\t<Form.Label>Category</Form.Label>\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Enter category\"\r\n\t\t\t\t\t\t\t\tvalue={category}\r\n\t\t\t\t\t\t\t\tonChange={(e) => setCategory(e.target.value)}\r\n\t\t\t\t\t\t\t></Form.Control>\r\n\t\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t\t<Form.Group controlId=\"countInStock\">\r\n\t\t\t\t\t\t\t<Form.Label>Count In Stock</Form.Label>\r\n\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Enter count In Stock\"\r\n\t\t\t\t\t\t\t\tvalue={countInStock}\r\n\t\t\t\t\t\t\t\tonChange={(e) => setCountInStock(e.target.value)}\r\n\t\t\t\t\t\t\t></Form.Control>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Button type=\"submit\" variant=\"primary\">\r\n\t\t\t\t\t\t\tUPDATE\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t)}\r\n\t\t\t</FormContainer>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default ProductEditScreen;\r\n"]},"metadata":{},"sourceType":"module"}